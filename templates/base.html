<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}–ú–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞{% endblock %}</title>
    <link id="theme-style" rel="stylesheet" href="/static/css/style.css">
</head>

<body class="page">
<header>
    <div class="container header-inner">
        <div class="logo">HomeStore</div>
            <nav class="header-nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
                <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/catalog">–ö–∞—Ç–∞–ª–æ–≥</a>
                <a href="/delivery">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</a>
                <a href="/sales">–ê–∫—Ü–∏–∏</a>
                <a href="/about">–û –∫–æ–º–ø–∞–Ω–∏–∏</a>
                <a href="/contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                <a href="/sitemap">–ö–∞—Ä—Ç–∞ —Å–∞–π—Ç–∞</a>
            </nav>
            <div class="header-right">
                <a href="/cart" class="cart-link" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">üõí{% if session.cart %}<span class="cart-badge">{{ session.cart | length }}</span>
            {% endif %}
                </a>
                {% if session.get("user") %}
                    <span class="user-name">–í—ã: {{ session.user.username }}</span>
                    <a href="/logout" class="header-link">–í—ã—Ö–æ–¥</a>
                {% if session.get("user") and session.user.role == "customer" %}
                    <a href="/orders" class="header-link">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</a>
                {% endif %}
                {% if session.user and session.user.role == "admin" %}
                    <a href="/admin" class="header-link">–ó–∞–∫–∞–∑—ã</a>
                {% endif %}

                {% else %}
                    <a href="/login" class="header-link">–í—Ö–æ–¥</a>
                {% endif %}
                <nav class="accessibility-nav" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                <div class="vision-toggle" role="region" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–µ—Ä—Å–∏–∏ –¥–ª—è —Å–ª–∞–±–æ–≤–∏–¥—è—â–∏—Ö">
                    <span id="vision-label" class="vision-label">–û–±—ã—á–Ω–∞—è –≤–µ—Ä—Å–∏—è</span>

                    <label class="switch" title="–í–∫–ª—é—á–∏—Ç—å –≤–µ—Ä—Å–∏—é –¥–ª—è —Å–ª–∞–±–æ–≤–∏–¥—è—â–∏—Ö">
                    <input
                        type="checkbox"
                        id="vision-mode-toggle"
                        role="switch"
                        aria-checked="false"
                        aria-labelledby="vision-label"
                    >
                    <span class="slider" aria-hidden="true"></span>
                    </label>
                </div>
                </nav>
            </div>  
        </div>
</header>

<main class="page-content">
    <div class="container">
        <form action="/search" method="get" class="catalog-search">
            <input
                type="text"
                name="q"
                placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É"
                value="{{ request.args.get('q', '') }}"
                required>
            <button class="btn">–ù–∞–π—Ç–∏</button>
        </form>
    </div>
    {% block content %}{% endblock %}
</main>

<footer>
    <div class="container">
        <div class="footer-col">¬© 2025 –°–µ—Ç—å –º–∞–≥–∞–∑–∏–Ω–æ–≤ HomeStore</div>
        <div class="footer-col">–í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</div>
    </div>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const slides = document.querySelectorAll(".slide");
    let current = 0;

    slides.forEach(slide => {
        slide.style.backgroundImage = `url(${slide.dataset.bg})`;
    });

    if (slides.length <= 1) return;

    setInterval(() => {
        slides[current].classList.remove("active");
        current = (current + 1) % slides.length;
        slides[current].classList.add("active");
    }, 4000);
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const checkbox = document.getElementById("vision-mode-toggle");
  const label = document.getElementById("vision-label");
  const themeLink = document.getElementById("theme-style");

  if (!checkbox || !themeLink || !label) return;

  // –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–∑–Ω–∞—á–µ–Ω–∏—è: "on" / "off")
  const saved = localStorage.getItem("vision-mode");

  const applyMode = (on) => {
    if (on) {
      themeLink.setAttribute("href", "/static/css/vision.css");
      checkbox.checked = true;
      checkbox.setAttribute("aria-checked", "true");
      label.textContent = "–í–µ—Ä—Å–∏—è –¥–ª—è —Å–ª–∞–±–æ–≤–∏–¥—è—â–∏—Ö";
    } else {
      themeLink.setAttribute("href", "/static/css/style.css");
      checkbox.checked = false;
      checkbox.setAttribute("aria-checked", "false");
      label.textContent = "–û–±—ã—á–Ω–∞—è –≤–µ—Ä—Å–∏—è";
    }
  };

  // –ø—Ä–∏–º–∏–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞, –µ—Å–ª–∏ –µ—Å—Ç—å
  applyMode(saved === "on");

  // –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  checkbox.addEventListener("change", () => {
    const on = checkbox.checked;
    applyMode(on);
    localStorage.setItem("vision-mode", on ? "on" : "off");
  });

});
</script>

</body>
</html>